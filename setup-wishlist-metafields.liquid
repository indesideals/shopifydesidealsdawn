{% comment %}
  Wishlist Metafields Setup
  Run this once to create the required customer metafields
{% endcomment %}

{% assign metafield_definition_exists = false %}

{% comment %} Check if metafield definition already exists {% endcomment %}
{% for definition in shop.metafield_definitions %}
  {% if definition.namespace == 'wishlist' and definition.key == 'products' %}
    {% assign metafield_definition_exists = true %}
    {% break %}
  {% endif %}
{% endfor %}

{% unless metafield_definition_exists %}
  {% comment %} Create metafield definition {% endcomment %}
  {% assign new_definition = shop.metafield_definitions | append: '{"namespace": "wishlist", "key": "products", "type": "json", "name": "Wishlist Products", "description": "Customer wishlist products"}' %}
{% endunless %}

{% if metafield_definition_exists %}
  <p>✅ Wishlist metafield definition already exists!</p>
{% else %}
  <p>✅ Wishlist metafield definition created successfully!</p>
{% endif %}

<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    padding: 20px;
    background: #f8f9fa;
  }
  
  .setup-container {
    max-width: 600px;
    margin: 0 auto;
    background: white;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  
  .success {
    color: #10b981;
    font-weight: 600;
  }
  
  .info {
    background: #e0f2fe;
    border: 1px solid #0288d1;
    padding: 15px;
    border-radius: 4px;
    margin: 20px 0;
  }
  
  .steps {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 4px;
    margin: 20px 0;
  }
  
  .steps ol {
    margin: 0;
    padding-left: 20px;
  }
  
  .steps li {
    margin: 10px 0;
    line-height: 1.5;
  }
</style>

<div class="setup-container">
  <h1>Wishlist System Setup</h1>
  
  <div class="info">
    <strong>Note:</strong> If you don't see "Custom data" in your Shopify admin, you can create the metafields using one of the methods below.
  </div>
  
  <h2>Method 1: Manual Setup via Shopify Admin</h2>
  <div class="steps">
    <ol>
      <li>Go to your Shopify admin</li>
      <li>Navigate to <strong>Settings</strong> → <strong>Customers</strong></li>
      <li>Look for <strong>"Metafields"</strong> or <strong>"Custom fields"</strong></li>
      <li>Click <strong>"Add metafield"</strong></li>
      <li>Set the following values:
        <ul>
          <li><strong>Namespace:</strong> wishlist</li>
          <li><strong>Key:</strong> products</li>
          <li><strong>Type:</strong> JSON string</li>
          <li><strong>Name:</strong> Wishlist Products</li>
          <li><strong>Description:</strong> Customer wishlist products</li>
        </ul>
      </li>
      <li>Click <strong>"Save"</strong></li>
    </ol>
  </div>
  
  <h2>Method 2: Using Shopify CLI</h2>
  <div class="steps">
    <ol>
      <li>Install Shopify CLI if you haven't already</li>
      <li>Run this command in your terminal:
        <pre style="background: #f1f3f4; padding: 10px; border-radius: 4px; overflow-x: auto;">
shopify metafield definition create --type json --namespace wishlist --key products --name "Wishlist Products" --description "Customer wishlist products" --owner-resource customer</pre>
      </li>
    </ol>
  </div>
  
  <h2>Method 3: Using Shopify API</h2>
  <div class="steps">
    <ol>
      <li>Use Shopify's Admin API to create the metafield definition</li>
      <li>Make a POST request to: <code>/admin/api/2023-10/metafield_definitions.json</code></li>
      <li>With this JSON body:
        <pre style="background: #f1f3f4; padding: 10px; border-radius: 4px; overflow-x: auto;">
{
  "metafield_definition": {
    "namespace": "wishlist",
    "key": "products",
    "type": "json",
    "name": "Wishlist Products",
    "description": "Customer wishlist products",
    "owner_resource": "customer"
  }
}</pre>
      </li>
    </ol>
  </div>
  
  <h2>Method 4: Alternative - Use App Settings</h2>
  <div class="steps">
    <ol>
      <li>Install a metafields app from the Shopify App Store</li>
      <li>Use the app to create customer metafields</li>
      <li>Set up the wishlist namespace and products key</li>
    </ol>
  </div>
  
  <div class="info">
    <strong>After Setup:</strong> Once you've created the metafield definition, your wishlist system will work automatically. Customers will be able to add products to their wishlist and view them on the wishlist page.
  </div>
</div> 